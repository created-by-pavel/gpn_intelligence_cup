# GPN_INTELLIGENCE_CUP 2022

## Описание решения:
Стэк: Spring Boot, Spring Cloud, vk-java-sdk, PostgreSQL, zipkin, Docker, jib, Caffeine, Springdoc-openapi  

Документация: http://localhost:8081/webjars/swagger-ui/index.html  
Docker-Hub: https://hub.docker.com/u/crbpavel

я реализовал 2 сервиса:
1. vk-Service - Сервис для работы с API VK
2. user-Service - Сервис для работы с аутентификацией  
Информация о пользователе хранится в БД (PostgreSQL)  


также в решении присутствует:
1. Eureka-Server - Сервис для регистрации и общения микросервисов
2. Api_Gateway - Сервис для роутинга запросов    
Этот сервис принимает запросы от пользователя, определяет к какому сервису идти, и перенаправляет запрос.
Также тут реализован Gateway-Filter, который проверяет наличие токена в хедере запроса и перенаправляет его на user-service для подтверждения.
После чего идет роутинг запроса к нужному сервису. Пока что, он навешан только на vk-Service. В дальнейшем этот фильтр можно навесить на другие сервисы, чтобы они могли работать только с авторизованными пользователями.

## Запуск:

### клонирование
```bash
git clone https://github.com/created-by-pavel/gpn_intelligence_cup
```

### настройка базы
```bash
docker-compose up postgres
```

```bash
docker exec -it postgres bash
psql -U crbpavel
CREATE DATABASE user;
```

### дальнейший запуск
дальнейший порядок запуска микросервисов не важен, тк в конце концов все они поднимутся и будут работать

```bash
docker-compose up -d
```

![alt text](https://sheleadsafrica.org/wp-content/uploads/2016/09/kanye_approves.gif)

## Описание задания

Необходимо разработать интеграционный RESTful cloud-native сервис на Java 
для получуния ФИО пользователя VK, а также признака участника группы VK. Для работы с VK 
следует использовать API ВКонтакте.

### Техническое описание сервиса:
Сервис должен реализовывать REST-метод на вход 
принимающий HTTP заголовок vk_service_token и тело запроса в формате JSON вида:
```json
{
  "user_id": "123456",
  "group_id": "654321"
}
```
Где:
* user_id - идентификатор пользователя VK
* group_id - идентификатор группы VK
* vk_service_token - сервисный ключ приложения VK используемый для доступа к API ВКонтакте

В ответ должно приходить тело ответа в формате JSON вида:
```json
{
  "last_name": "Иванов",
  "first_name": "Иван",
  "middle_name": "Иванович",
  "member": true
}
```
Где:
* last_name - фамилия пользователя user_id
* first_name - имя пользователя user_id
* last_name - отчество пользователя user_id
* member - признак того, что пользователь состоит в группе group_id

В приложении должен быть реализованы:
* Валидация запросов на предмет корретности формата и передаваемых полей
* Обработка ошибок VK с выдачей информативного ответа
* Swagger или OpenApi документация
* JUnit тесты

ДОПОЛНИТЕЛЬНО:
- [x] Своя авторизация для API нашего приложения (BASIC или Oauth)
- [x] Кеширование ответов на стороне нашего приложения
- [ ] Сборка и деплой приложения в облако (например локально в minikube/minishift)
  - [x] сборка
  - [ ] деплой
